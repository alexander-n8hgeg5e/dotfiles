#!/bin/fish

set -x DISPLAY tc:0
# echo $DISPLAY
#set cmdline_esadc "sudo nice -n-20 ionice -c1 -n3 chrt -rr 30 sudo -u $USER X :1 -ardelay 130 -arinterval 50 -listen inet +iglx -depth 24 vt7"

#set cmdline_skyscraper "nice -n-20 ionice -c1 -n3 chrt -rr 30 X :1 -ardelay 130 -arinterval 50 -listen inet +iglx -depth 24 vt7"

set hostname (hostname)

function clean
    killall redshift
    killall conky
    killall clipster
    killall st
    killall openbox
    wm_conf_adj
end

#function xserver_wait_prog
#    st -t waitprog -e fish -C "function fish_title
#	end
#	echo This is xserver waiting shell. Exiting this shell will terminate xserver."
#end

#function xserver_start
#    for i in esadc skyscraper
#        set varname cmdline_$i
#        if test $hostname = $i
#            echo
#            echo starting xserver on $i ...
#            echo
#            eval $$varname &
#            echo starting spice viewer ..
#            set -x DISPLAY :1
#            eval spicy -h 127.0.0.1 -p 4300 -f &
#        else
#            echo
#            echo starting xserver via ssh on $i ...
#            echo
#            ssh $i'_xserver' $$varname &
#            echo starting spice viewer ..
#            set -x DISPLAY :1
#            ssh $i'_xserver'  'spicy -h esadc -p 4300 -f' & 
#            set -x DISPLAY :1
#            echo done $i
#        end
#    end
#end
#
#if test $argv[1] = c   #clean
#    clean
#end

#xserver_start &
pulseaudio -D &
#redshift -c ~/.redshift_esadc.conf &
#clipster -d &
#screen_on_control &
#st -e TM &
#while not ps -C st
#    sleep 0.5
#end
setup_x
rind st
qtile start
#sc -r &
#openbox
#i3 -c "$HOME""/.config/i3/config_esadc:0"
